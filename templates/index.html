<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Micro Netflix Ads - Demo</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/netflix-style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="netflix-container">
        <!-- Netflix Header -->
        <header class="netflix-header">
            <div class="logo">
                <h1>MICROFLIX</h1>
            </div>
            <nav class="netflix-nav">
                <a href="/" class="active">Home</a>
                <a href="/dashboard">Analytics</a>
                <a href="/test">Test Mode</a>
            </nav>
            <div class="user-menu">
                <span>Demo User</span>
                <i class="fas fa-user-circle"></i>
            </div>
        </header>

        <!-- Hero Section -->
        <section class="hero-section">
            <div class="hero-content">
                <h1>Ad Optimization Demo</h1>
                <p>Select a show to see personalized ad insertion powered by ML</p>
            </div>
        </section>

        <!-- Shows Grid -->
        <section class="shows-section">
            <h2 class="section-title">Popular Shows</h2>
            <div class="shows-carousel">
                {% for movie in movies %}
                <div class="show-card" onclick="playMovie('{{ movie.id }}', '{{ movie.genre }}')">
                    <img src="{{ movie.thumbnail }}" alt="{{ movie.title }}">
                    <div class="show-info">
                        <h3>{{ movie.title }}</h3>
                        <span class="genre">{{ movie.genre }}</span>
                    </div>
                    <div class="play-overlay">
                        <i class="fas fa-play-circle"></i>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

        <!-- Video Player Modal -->
        <div id="videoPlayerModal" class="video-modal" style="display: none;">
            <div class="video-container">
                <video id="mainVideo" controls>
                    <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
                
                <!-- Ad Overlay -->
                <div id="adOverlay" class="ad-overlay" style="display: none;">
                    <div class="ad-container">
                        <div class="ad-header">
                            <span>Ad</span>
                            <span id="skipTimer">Skip in <span id="countdown">5</span>s</span>
                            <button id="skipButton" class="skip-button" style="display: none;" onclick="skipAd()">Skip Ad</button>
                        </div>
                        <div id="adContent" class="ad-content">
                            <!-- Dynamic ad content will be inserted here -->
                        </div>
                        <button class="ad-cta" onclick="clickAd()">Learn More</button>
                    </div>
                </div>
                
                <button class="close-video" onclick="closeVideo()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <!-- User Profile Section (Hidden but used for data) -->
        <form id="userProfileForm" style="display: none;">
            <input type="number" name="age" value="28">
            <select name="gender"><option value="Male">Male</option></select>
            <select name="subscription_tier"><option value="Standard">Standard</option></select>
            <input type="number" name="watch_hours" value="30">
            <select name="genre_preference"><option value="Action">Action</option></select>
            <select name="device"><option value="smart_tv">Smart TV</option></select>
        </form>

        <!-- LLM Chat Widget -->
        <div class="chat-widget">
            <div class="chat-header" onclick="toggleChat()">
                <i class="fas fa-comments"></i>
                <span>Ask about campaigns</span>
                <i class="fas fa-chevron-up" id="chatToggle"></i>
            </div>
            <div class="chat-body" id="chatBody" style="display: none;">
                <div class="chat-messages" id="chatMessages">
                    <div class="message bot">
                        <p>Hi! I can help you understand our ad campaigns. Ask me anything!</p>
                    </div>
                </div>
                <div class="chat-input">
                    <input type="text" id="chatInput" placeholder="Type your question..." onkeypress="handleChatKeypress(event)">
                    <button onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/netflix-app.js') }}"></script>
</body>
</html>